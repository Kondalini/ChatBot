ç/defVar --name pathDataPicker --type String
defVar --name lang --type Language
defVar --name options --type List --innertype String --value "[Calendar,Other]"
defVar --name selectedOption --type String
defVar --name trueAttachTab --type Boolean
defVar --name chrome --type Browser
defVar --name calendar --type String
defVar --name ex --type Excel
defVar --name dataTable --type DataTable
defVar --name cards --type List --innertype CardItem
defVar --name userResponse --type String
defVar --name id --type Numeric
defVar --name ChoosenDate --type String
defVar --name tabDoc --type Browser
import --name dataPicker --type "File" --content DQoNCjwhRE9DVFlQRSBodG1sPg0KPGh0bWwgbGFuZz0iZW4iPg0KPGhlYWQ+DQogICAgPG1ldGEgY2hhcnNldD0iVVRGLTgiPg0KICAgIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MS4wIj4NCiAgICA8dGl0bGU+RG9jdW1lbnQ8L3RpdGxlPg0KDQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvanF1ZXJ5L2xhdGVzdC9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4NCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9tb21lbnRqcy9sYXRlc3QvbW9tZW50Lm1pbi5qcyI+PC9zY3JpcHQ+DQo8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2RhdGVyYW5nZXBpY2tlci9kYXRlcmFuZ2VwaWNrZXIubWluLmpzIj48L3NjcmlwdD4NCjxsaW5rIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIGhyZWY9Imh0dHBzOi8vY2RuLmpzZGVsaXZyLm5ldC9ucG0vZGF0ZXJhbmdlcGlja2VyL2RhdGVyYW5nZXBpY2tlci5jc3MiIC8+DQoNCjxzdHlsZT4NCiAgICAgICAgI3JlcG9ydHJhbmdlIHsNCiAgICAgICAgICAgIGhlaWdodDogMzhweDsNCiAgICAgICAgICAgIHBvc2l0aW9uOiBmaXhlZDsNCiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiA1MHB4Ow0KICAgICAgICAgICAgYm90dG9tOiAyMDA7DQogICAgICAgICAgICB6LWluZGV4OiAxMDAwOw0KICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzAwMGZmZjsNCiAgICAgICAgfQ0KDQogICAgICAgIA0KICAgICAgICANCiAgICA8L3N0eWxlPg0KPGRpdiBpZD0icmVwb3J0cmFuZ2UiIHN0eWxlPSJiYWNrZ3JvdW5kOiAjZmZmOyBjdXJzb3I6IHBvaW50ZXI7IHBhZGRpbmc6IDVweCAxMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjY2NjOyB3aWR0aDogMzAlIj4NCiAgICA8aSBjbGFzcz0iZmEgZmEtY2FsZW5kYXIiPjwvaT4mbmJzcDsNCiAgICA8c3Bhbj48L3NwYW4+IDxpIGNsYXNzPSJmYSBmYS1jYXJldC1kb3duIj48L2k+DQo8L2Rpdj4NCg0KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KJChmdW5jdGlvbigpIHsNCg0KICAgIHZhciBzdGFydCA9IG1vbWVudCgpLnN1YnRyYWN0KDI5LCAnZGF5cycpOw0KICAgIHZhciBlbmQgPSBtb21lbnQoKTsNCg0KICAgIGZ1bmN0aW9uIGNiKHN0YXJ0LCBlbmQpIHsNCiAgICAgICAgJCgnI3JlcG9ydHJhbmdlIHNwYW4nKS5odG1sKHN0YXJ0LmZvcm1hdCgnTU1NTSBELCBZWVlZJykgKyAnIC0gJyArIGVuZC5mb3JtYXQoJ01NTU0gRCwgWVlZWScpKTsNCiAgICB9DQoNCiAgICAkKCcjcmVwb3J0cmFuZ2UnKS5kYXRlcmFuZ2VwaWNrZXIoew0KICAgICAgICBzdGFydERhdGU6IHN0YXJ0LA0KICAgICAgICBlbmREYXRlOiBlbmQsDQogICAgICAgIHJhbmdlczogew0KICAgICAgICAgICAnVG9kYXknOiBbbW9tZW50KCksIG1vbWVudCgpXSwNCiAgICAgICAgICAgJ1llc3RlcmRheSc6IFttb21lbnQoKS5zdWJ0cmFjdCgxLCAnZGF5cycpLCBtb21lbnQoKS5zdWJ0cmFjdCgxLCAnZGF5cycpXSwNCiAgICAgICAgICAgJ0xhc3QgNyBEYXlzJzogW21vbWVudCgpLnN1YnRyYWN0KDYsICdkYXlzJyksIG1vbWVudCgpXSwNCiAgICAgICAgICAgJ0xhc3QgMzAgRGF5cyc6IFttb21lbnQoKS5zdWJ0cmFjdCgyOSwgJ2RheXMnKSwgbW9tZW50KCldLA0KICAgICAgICAgICAnVGhpcyBNb250aCc6IFttb21lbnQoKS5zdGFydE9mKCdtb250aCcpLCBtb21lbnQoKS5lbmRPZignbW9udGgnKV0sDQogICAgICAgICAgICdMYXN0IE1vbnRoJzogW21vbWVudCgpLnN1YnRyYWN0KDEsICdtb250aCcpLnN0YXJ0T2YoJ21vbnRoJyksIG1vbWVudCgpLnN1YnRyYWN0KDEsICdtb250aCcpLmVuZE9mKCdtb250aCcpXQ0KICAgICAgICB9DQogICAgfSwgY2IpOw0KDQogICAgY2Ioc3RhcnQsIGVuZCk7DQoNCn0pOw0KPC9zY3JpcHQ+ --extension ".html"
import --name image1 --type "Image" --content iVBORw0KGgoAAAANSUhEUgAAAHIAAAAQCAYAAADK4SssAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAACiSURBVFhH7dgxCsQgEIXhURDUi1h5AI/inbyNhUfxFinSaKXLzi5bZdtAhvdBEIypfiQw6jjOTfB4+rvCwyGkEAgphBpj4B8pAG6kEAgpBEIKgZBCIKQQCCkEQgqBkEIgpBB/Q+79GfiUUsg5d/l47ymlRL13PrvW4hXudzmiewfRWlNrjXLOHDOEwPtKKT4z5+R31loyxlCtlWKMv2/hTkQvr0csPnhE2owAAAAASUVORK5CYII=
export --asset "${asset.dataPicker}" pathDataPicker=value
createLanguage --culture "en-US" lang=value
botConnect --language ${lang}
	botAskList --names ${options} --language ${lang} --text "Hi! Please select:" --textformat "Markdown" selectedOption=value
	if --left "${selectedOption}" --operator "Equal_To" --right Calendar
		excelOpen --file "C:\\Users\\akrastev\\OneDrive - Service Centrix Ltd\\Desktop\\cards.xlsx" ex=value
		excelGetTable --file ${ex} --getfirstsheet  --entiretable  --hasheaders  dataTable=value
		// After opening our excel file, we go mapping thil fil  to obtain the casds and demonstrate it
		mapTableToCard --dataTable ${dataTable} --titleColumn 1 --subtitleColumn 2 --textColumn 3 --thumbnailUrlColumn 4 --actionColumn 5 --actionValueColumn 6 cards=value
		mapTableToCardButtons --dataTable ${dataTable} --cardItems ${cards} --buttonActionColumn 7 --buttonTextColumn 8 --buttonValueColumn 9
		// This command will be risponsible to display the cards in the webchat	
		chatAskCarousel --cards ${cards} --text "Choose the desired service to make the appointment." --textformat "Markdown" --timeout "00:02:00" userResponse=value
		gosubIf --label Pickdate --left "${userResponse}" --operator "Equal_To" --right Calendar
	endIf
	logMessage --message "${pathDataPicker}" --type "Info"
botDisconnect


beginSub --name Pickdate
webStart --name chrome --type "Chrome" --userprofilepreferences "AutomationOptimized" --downloadpath "C:\\Users\\akrastev\\AppData\\Local\\IBM Robotic Process Automation\\downloads" chrome=value
webNavigate --url "file:///C:/Users/akrastev/OneDrive%20-%20Service%20Centrix%20Ltd/Desktop/dataPicker1.html"
webWaitTab --title Document tabDoc=value trueAttachTab=success
webGet --selector "XPath" --xpath "//*[@id=\"reportrange\"]" ChoosenDate=value
webCloseTab
botAsk --language ${lang} --text "Is this it correct piched date: \r\n${ChoosenDate}" --textformat "Markdown" --timeout "00:00:20" userResponse=value
if --left "${userResponse}" --operator "Begins_With" --right Yes
	delay --timeout "00:00:03"
	botSay --language ${lang} --text "Thank you see you later!" --textformat "Markdown"
	delay --timeout "00:00:03"
endIf
webClose --name chrome --leavebrowseropen 
endSub*23.0.6.0